<!DOCTYPE html>
<html ng-app="myApp">
<head>
    <title>Assignment&copy;</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/app.css">

     <script src "node_modules/jquery/dist/cdn/jquery.min.js"></script>
    <!--<script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>-->
    <script src="node_modules/angular/angular.min.js"></script>
    <script src="node_modules/angular-route/angular-route.min.js"></script>
    <script src="javascript/app/app.js"></script>
</head>
<body ng-controller="mainConrtoller">
    <div class="app-container">
        <div class="app-header-container">
            <ul class="app-header">
                <li>Changelist/Built</li>
                <li>Owner</li>
                <li>Time Started</li>
                <li>State</li>
                <li>Metrics</li>
                <li>Build</li>
                <li>Unit Test</li>
                <li>Functional Test</li>
            </ul>
        </div>
        

        <div>
            <div ng-repeat="test in Tests">
                <div class="panel" ng-class="test.state">
                    <ul class="panel-header vertical-align">
                    <li class="changelist-build">
                        <div>
                            <span class="fa fa-building-o font-size"></span>&nbsp;<a href="" ng-click="setSelectedIndex($index);">432461</a>
                        </div>
                    </li>
                    <li class="owner">
                        <div>
                            <label>Samy</label>
                        </div>
                    </li>
                    <li>
                        <div class="time-started">
                            <label>4/14/2014 10:53PM</label>
                        </div>
                    </li>
                    <li class="state">
                        <div>
                            <label>{{test.state}} </label>
                        </div>
                    </li>
                    <li class="bar-wrapper">
                        <div class="bar1"></div>
                    </li>
                    <li class="bar-wrapper">
                        <div class="bar2"></div>
                    </li>
                    <li class="bar-wrapper">
                        <div class="bar3"> </div>
                    </li>
                    <li class="bar-wrapper">
                        <div class="bar4"></div>
                    </li>
                </ul>
                <div ng-show="(($index == selectedIndex) && (test.state == 'accepted' || test.state == 'rejected'))">
                    <ul class="dashboard" >
                        <li class="dashboard-widget metrics">
                            <p>Metrics</p>
                            <div class="text-center">
                                <div>
                                    <div class="icon-container">
                                        <span class="fa fa-arrow-up green-icon"></span>
                                        <p class="test">64</p>
                                        <h6>Test</h6>
                                    </div>
                                    <div class="icon-container">
                                        <span class="fa fa-arrow-down maroon-icon"></span>
                                        <p class="maintainability">53</p>
                                        <h6>Maintainability</h6>
                                    </div>
                                </div>
                                <div>
                                    <div class="icon-container">
                                        <span class="fa fa-arrow-right golden-icon"></span>
                                        <p class="security">64</p>
                                        <h6>Security</h6>
                                    </div>
                                    <div class="icon-container">
                                        <span class="fa fa-arrow-right golden-icon"></span>
                                        <p class="workmanship">72</p>
                                        <h6>Workmanship</h6>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="dashboard-widget build">
                            <p>Build</p>
                            <div class="text-center margin-top-laptop-icons">
                                <div class="icon-container">
                                    <span class="fa fa-laptop blue-icon"></span>
                                    <h6 class="blue">Debug</h6>
                                </div>
                                <div class="icon-container">
                                    <span class="fa fa-laptop blue-icon"></span>
                                    <h6 class="blue">Release</h6>
                                </div>
                            </div>
                            <footer class="timestamp text-center">10:46AM 4-14-2014</footer>
                        </li>
                        <li class="dashboard-widget unit-test">
                            <p>Unit Test</p>
                            <div class="piechart-container">
                                <canvas id="canvas" width="150" height="150"></canvas>
                            </div>
                            <div class="test-pass-container">
                                <label>73%</label>
                                <p>tests passed</p>
                            </div>
                            <div class="progress1">
                                <progress min="0" max="100" value="80"></progress>
                                <div class="progress-bar-label">
                                    <span>76%</span>
                                    <p>code covered</p>
                                </div>
                            </div>
                        </li>
                        <li class="dashboard-widget functional-test">
                            <p>Functional Test</p>
                            <div class="piechart-container">
                            <canvas id="piechart" width="100" height="100"></canvas>
                        </div>
                        <div class="progress1">
                            <progress min="0" max="100" value="80"></progress>
                            <div class="progress-bar-label">
                                <span>76%</span>
                                <p>code covered</p>
                            </div>
                        </div>
                        </li>
                        <li class="dashboard-widget">
                            <div class="text-center">
                                <p class="result">Result:</p>
                                <label class="maroon">Change Rejected</label>
                                <h1 class="maroon">Metrics Reduction</h1>
                                <input type="button" class="button-color-blue" value="Find Issues">
                            </div>
                        </li>
                    </ul>
                </div>

                </div>
            </div>
          

        </div>
    </div>
    <!--Accepted ends-->
    <!--Test Script-->
    <script>

    var myApp = angular.module('myApp', []);
    myApp.controller('mainConrtoller',function($scope){

        $scope.Tests = [{
            state:'running'
        },{
            state:'rejected'
        },{
            state:'accepted'
        }];
        
        //Index variable to control show - hide
        $scope.selectedIndex = -1;

        // fetch data from Json

        $scope.setSelectedIndex = function(index){
                $scope.selectedIndex = index;
        };
    });




    /*Pi Chart*/
    // var canvas = document.getElementById("canvas");
    // var ctx = canvas.getContext("2d");
    // var cw = canvas.width;
    // var ch = canvas.height;
    // ctx.lineWidth = 2;
    // ctx.font = '12px verdana';
    // var PI2 = Math.PI * 2;
    // var myColor = ["#53883E", "#DBA126"];
    // var myData = [40, 60];
    // var cx = Math.floor(canvas.width / 2);
    // var cy = Math.floor(canvas.height / 2);
    // var radius = Math.floor(canvas.width / 2) - 1;
    // pieChart(myData, myColor);

    function pieChart(data, colors) {

        var total = 0;
        for (var i = 0; i < data.length; i++) {
            total += data[i];
        }

        var sweeps = []
        for (var i = 0; i < data.length; i++) {
            sweeps.push(data[i] / total * PI2);
        }

        var accumAngle = 0;
        for (var i = 0; i < sweeps.length; i++) {
            drawWedge(accumAngle, accumAngle + sweeps[i], colors[i], data[i]);
            accumAngle += sweeps[i];
        }
    }

    function drawWedge(startAngle, endAngle, fill, label) {

            // draw the wedge
            ctx.beginPath();
            ctx.moveTo(cx, cy);
            ctx.arc(cx, cy, radius, startAngle, endAngle, false);
            ctx.closePath();
            ctx.fillStyle = fill;
            ctx.strokeStyle = 'grey';
            ctx.fill();
            ctx.stroke();

            // draw the label
            var midAngle = startAngle + (endAngle - startAngle) / 2;
            var labelRadius = radius * .75;
            var x = cx + (labelRadius) * Math.cos(midAngle);
            var y = cy + (labelRadius) * Math.sin(midAngle);
            ctx.fillStyle = 'white';
            ctx.fillText(label, x, y);
    }
        /*Pi Chart ends*/
    </script>
    <!--Test Script ends-->
   
</body>
</html>
